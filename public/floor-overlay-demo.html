<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Floor Interactive Overlay - Perspective Perfect</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        /* Main container for the building */
        .building-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Building image */
        .building-image {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Overlay container */
        .floor-overlays {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        /* Individual floor overlay */
        .floor-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            pointer-events: auto;
            transition: all 0.3s ease-in-out;
        }

        /* Floor highlight polygon */
        .floor-highlight {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .floor-overlay:hover .floor-highlight {
            opacity: 1;
        }

        .floor-overlay.selected .floor-highlight {
            opacity: 1;
            animation: pulse 2s infinite;
        }

        /* Floor label */
        .floor-label {
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            font-size: 14px;
            font-weight: 600;
            color: #333;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.9);
            transition: all 0.3s ease-in-out;
            pointer-events: none;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .floor-overlay:hover .floor-label,
        .floor-overlay.selected .floor-label {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        /* Shimmer effect for selected floors */
        @keyframes pulse {
            0%, 100% { 
                filter: brightness(1);
            }
            50% { 
                filter: brightness(1.2);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        /* Info panel */
        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .info-panel h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
            color: #333;
        }

        .info-panel p {
            margin: 0;
            font-size: 12px;
            color: #666;
        }

        /* Legend */
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 15px;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        /* Details panel */
        .details-panel {
            max-width: 800px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .details-panel.active {
            display: block;
        }

        .details-panel h3 {
            margin: 0 0 15px 0;
            color: #333;
        }

        .details-table {
            width: 100%;
            border-collapse: collapse;
        }

        .details-table th,
        .details-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .details-table th {
            font-weight: 600;
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
        }

        .details-table td {
            font-size: 14px;
            color: #333;
        }

        .status-available { color: #22c55e; }
        .status-partial { color: #eab308; }
        .status-sold { color: #ef4444; }
    </style>
</head>
<body>
    <div class="building-container">
        <!-- Building Image - Replace src with your image -->
        <img src="/src/assets/images/002.jpg" alt="Building" class="building-image" id="buildingImage">
        
        <!-- Floor Overlays Container -->
        <div class="floor-overlays" id="floorOverlays"></div>
        
        <!-- Info Panel -->
        <div class="info-panel">
            <h3>Интерактивен план</h3>
            <p>Посочете етаж за информация</p>
        </div>
        
        <!-- Legend -->
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #22c55e;"></div>
                <span>Свободен</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #eab308;"></div>
                <span>Частично</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ef4444;"></div>
                <span>Продаден</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #9ca3af;"></div>
                <span>Гаражи</span>
            </div>
        </div>
    </div>
    
    <!-- Details Panel -->
    <div class="details-panel" id="detailsPanel">
        <h3 id="detailsTitle">Floor Details</h3>
        <table class="details-table">
            <thead>
                <tr>
                    <th>Имот</th>
                    <th>Вид</th>
                    <th>Застроена площ</th>
                    <th>Обща площ</th>
                    <th>Изложение</th>
                    <th>Статус</th>
                </tr>
            </thead>
            <tbody id="detailsTableBody">
                <!-- Content will be inserted here -->
            </tbody>
        </table>
    </div>

    <script>
        // Floor data with precise polygon coordinates (percentage-based)
        const floors = [
            {
                id: 6,
                name: "Етаж 6",
                // 4-point polygon: [x%, y%] for each corner
                points: [[20, 10], [80, 10], [80, 22], [20, 22]],
                color: 'rgba(255, 215, 0, 0.5)', // Gold
                status: 'partial',
                apartments: [
                    { property: 'Апартамент 6А', type: 'Тристаен', builtArea: '85 м²', totalArea: '95 м²', exposure: 'Изток/Запад', status: 'Резервиран' },
                    { property: 'Апартамент 6Б', type: 'Двустаен', builtArea: '65 м²', totalArea: '75 м²', exposure: 'Север/Юг', status: 'Свободен' }
                ]
            },
            {
                id: 5,
                name: "Етаж 5",
                points: [[20, 22], [80, 22], [80, 34], [20, 34]],
                color: 'rgba(34, 197, 94, 0.5)', // Green
                status: 'available',
                apartments: [
                    { property: 'Апартамент 5А', type: 'Тристаен', builtArea: '88 м²', totalArea: '98 м²', exposure: 'Юг/Запад', status: 'Свободен' },
                    { property: 'Апартамент 5Б', type: 'Двустаен', builtArea: '70 м²', totalArea: '80 м²', exposure: 'Север/Изток', status: 'Свободен' }
                ]
            },
            {
                id: 4,
                name: "Етаж 4",
                points: [[20, 34], [80, 34], [80, 46], [20, 46]],
                color: 'rgba(239, 68, 68, 0.5)', // Red
                status: 'sold',
                apartments: [
                    { property: 'Апартамент 4А', type: 'Двустаен', builtArea: '70 м²', totalArea: '80 м²', exposure: 'Изток/Запад', status: 'Продаден' },
                    { property: 'Апартамент 4Б', type: 'Тристаен', builtArea: '88 м²', totalArea: '98 м²', exposure: 'Север/Изток', status: 'Продаден' }
                ]
            },
            {
                id: 3,
                name: "Етаж 3",
                points: [[20, 46], [80, 46], [80, 58], [20, 58]],
                color: 'rgba(34, 197, 94, 0.5)', // Green
                status: 'available',
                apartments: [
                    { property: 'Апартамент 3А', type: 'Четиристаен', builtArea: '110 м²', totalArea: '125 м²', exposure: 'Юг/Изток', status: 'Свободен' },
                    { property: 'Апартамент 3Б', type: 'Двустаен', builtArea: '62 м²', totalArea: '72 м²', exposure: 'Запад', status: 'Свободен' }
                ]
            },
            {
                id: 2,
                name: "Етаж 2",
                points: [[20, 58], [80, 58], [80, 70], [20, 70]],
                color: 'rgba(255, 215, 0, 0.5)', // Gold
                status: 'partial',
                apartments: [
                    { property: 'Апартамент 2А', type: 'Тристаен', builtArea: '85 м²', totalArea: '95 м²', exposure: 'Юг/Изток', status: 'Резервиран' },
                    { property: 'Апартамент 2Б', type: 'Двустаен', builtArea: '68 м²', totalArea: '78 м²', exposure: 'Север', status: 'Свободен' }
                ]
            },
            {
                id: 1,
                name: "Етаж 1",
                points: [[20, 70], [80, 70], [80, 82], [20, 82]],
                color: 'rgba(34, 197, 94, 0.5)', // Green
                status: 'available',
                apartments: [
                    { property: 'Апартамент 1А', type: 'Двустаен', builtArea: '72 м²', totalArea: '85 м²', exposure: 'Юг/Запад', status: 'Свободен' },
                    { property: 'Апартамент 1Б', type: 'Тристаен', builtArea: '95 м²', totalArea: '110 м²', exposure: 'Изток/Юг', status: 'Свободен' }
                ]
            },
            {
                id: 0,
                name: "Партер - Гаражи",
                points: [[18, 82], [82, 82], [82, 95], [18, 95]], // Wider for garage
                color: 'rgba(156, 163, 175, 0.5)', // Gray
                status: 'garage',
                apartments: [
                    { property: 'Гараж 1', type: 'Гараж', builtArea: '15 м²', totalArea: '15 м²', exposure: '-', status: 'Свободен' },
                    { property: 'Гараж 2', type: 'Гараж', builtArea: '18 м²', totalArea: '18 м²', exposure: '-', status: 'Свободен' }
                ]
            }
        ];

        // Convert points to clip-path polygon
        function pointsToClipPath(points) {
            return `polygon(${points.map(p => `${p[0]}% ${p[1]}%`).join(', ')})`;
        }

        // Create floor overlays
        function createFloorOverlays() {
            const overlaysContainer = document.getElementById('floorOverlays');
            
            floors.forEach(floor => {
                // Create floor overlay element
                const floorDiv = document.createElement('div');
                floorDiv.className = 'floor-overlay';
                floorDiv.dataset.floorId = floor.id;
                
                // Create highlight polygon
                const highlight = document.createElement('div');
                highlight.className = 'floor-highlight';
                highlight.style.clipPath = pointsToClipPath(floor.points);
                highlight.style.backgroundColor = floor.color;
                
                // Create label
                const label = document.createElement('div');
                label.className = 'floor-label';
                label.textContent = floor.name;
                // Position label in center of polygon
                const centerX = (floor.points[0][0] + floor.points[1][0]) / 2;
                const centerY = (floor.points[0][1] + floor.points[2][1]) / 2;
                label.style.left = `${centerX}%`;
                label.style.top = `${centerY}%`;
                
                // Add elements
                floorDiv.appendChild(highlight);
                floorDiv.appendChild(label);
                overlaysContainer.appendChild(floorDiv);
                
                // Add click handler
                floorDiv.addEventListener('click', () => selectFloor(floor));
            });
        }

        // Handle floor selection
        let selectedFloor = null;
        
        function selectFloor(floor) {
            // Update selected state
            document.querySelectorAll('.floor-overlay').forEach(el => {
                el.classList.remove('selected');
            });
            
            if (selectedFloor === floor.id) {
                selectedFloor = null;
                document.getElementById('detailsPanel').classList.remove('active');
            } else {
                selectedFloor = floor.id;
                document.querySelector(`[data-floor-id="${floor.id}"]`).classList.add('selected');
                showDetails(floor);
            }
        }

        // Show floor details
        function showDetails(floor) {
            const panel = document.getElementById('detailsPanel');
            const title = document.getElementById('detailsTitle');
            const tbody = document.getElementById('detailsTableBody');
            
            title.textContent = floor.name;
            
            // Clear existing rows
            tbody.innerHTML = '';
            
            // Add apartment rows
            floor.apartments.forEach(apt => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${apt.property}</td>
                    <td>${apt.type}</td>
                    <td>${apt.builtArea}</td>
                    <td>${apt.totalArea}</td>
                    <td>${apt.exposure}</td>
                    <td class="status-${floor.status}">${apt.status}</td>
                `;
            });
            
            panel.classList.add('active');
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', createFloorOverlays);
        
        // Handle window resize
        window.addEventListener('resize', () => {
            // Overlays automatically scale with percentage-based coordinates
            console.log('Window resized - overlays remain aligned');
        });
    </script>
</body>
</html>